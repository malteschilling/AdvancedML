<!DOCTYPE html><html><head><meta charset="utf-8">
<script src="assets/d3.min.js"></script>
<script src="http://distill.pub/template.v1.js"></script>
<script type="text/front-matter">
  title: Attention and Augmented Recurrent Neural Networks
  description: A visual overview of neural attention, and the powerful extensions of neural networks being built on top of it.
  authors:
    - Chris Olah: http://colah.github.io
    - Shan Carter: http://shancarter.com
  affiliations:
    - Google Brain: http://g.co/brain
    - Google Brain: http://g.co/brain
</script>

<style>
#previews a {
  text-decoration: none;
  overflow: hidden;
  margin-bottom: 12px;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 12px;
  padding-bottom: 12px;

}
#previews figcaption {
  margin-left: 100px;
}
#previews svg, #previews img {
  width: 80px;
  float: left;
}

@media(min-width: 768px) {
  #previews {
    overflow: hidden;
    margin-top: 48px;
    margin-bottom: 48px;
  }
  #previews figcaption {
    margin-left: 0;
  }
  #previews figcaption b {
    display: block;
  }
  #previews figcaption b span {
    display: block;
  }
  #previews a {
    position: relative;
    float: left;
    width: 19%;
    margin-right: 3.6%;
    padding-right: 3.6%;
    border-right: 1px solid rgba(0, 0, 0, 0.05);
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
  }
  #previews a:last-child {
    margin-right: 0;
    padding-right: 0;
    border-right: 0;
  }
  #previews svg, #previews img {
    margin-bottom: 18px;
    display: block;
    width: 100%;
    float: none;
  }
}

@media(min-width: 1024px) {
  #previews {
    margin-top: 90px;
    margin-bottom: 90px;
  }
}
</style>

</head><body><dt-article class="centered">

  <style>
    #previews a {
      text-decoration: none;
      overflow: hidden;
      margin-bottom: 12px;
      display: block;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      margin-bottom: 12px;
      padding-bottom: 12px;

  }
    #previews figcaption {
      margin-left: 100px;
    }
    #previews svg, #previews img {
      width: 80px;
      float: left;
    }

  @media(min-width: 768px) {
      #previews {
        overflow: hidden;
        margin-top: 48px;
        margin-bottom: 48px;
      }
      #previews figcaption {
        margin-left: 0;
      }
      #previews figcaption b {
        display: block;
      }
      #previews figcaption b span {
        display: block;
      }
      #previews a {
        position: relative;
        float: left;
        width: 19%;
        margin-right: 3.6%;
        padding-right: 3.6%;
        border-right: 1px solid rgba(0, 0, 0, 0.05);
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
      }
      #previews a:last-child {
        margin-right: 0;
        padding-right: 0;
        border-right: 0;
      }
      #previews svg, #previews img {
        margin-bottom: 18px;
        display: block;
        width: 100%;
        float: none;
      }
    }

  @media(min-width: 1024px) {
    #previews {
      margin-top: 90px;
      margin-bottom: 90px;
    }
  }
  </style>
  <p></p><figure class="l-body-outset" id="rnn-read">
    <dt-include src="assets/rnn_read.svg"><svg id="edges" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 744 252">
  <defs>
    <symbol id="array-7" data-name="array-7" viewBox="0 0 253.5 37.5">
      <rect x="0.75" y="0.75" width="252" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"></rect>
      <line x1="36.25" y1="36.75" x2="36.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="72.25" y1="36.75" x2="72.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="108.25" y1="36.75" x2="108.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="144.25" y1="36.75" x2="144.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="180.25" y1="36.75" x2="180.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="216.25" y1="36.75" x2="216.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
    </symbol>
    <symbol id="array-1" data-name="array-1" viewBox="0 0 37.5 37.5">
      <rect x="0.75" y="0.75" width="36" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"></rect>
    </symbol>
    <symbol id="array-vector" data-name="array-vector" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#d8c2f2" opacity="0"></rect>
      <g opacity="0.5">
        <g>
          <line x1="18" y1="24" x2="18" y2="13.08" fill="none" stroke="#000" stroke-miterlimit="10"></line>
          <polygon points="22.09 16.4 21.36 17.08 18 13.47 14.64 17.08 13.91 16.4 18 12 22.09 16.4"></polygon>
        </g>
      </g>
    </symbol>
    <symbol id="array-positive-value" data-name="array-positive-value" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#0080f7" opacity="0"></rect>
      <rect x="4.42" y="4.42" width="27.17" height="27.17" rx="6" ry="6" fill="#3a5edd" opacity="0.8"></rect>
    </symbol>
    <symbol id="pointer" data-name="pointer" viewBox="0 0 26.87 26.87">
      <circle cx="13.43" cy="13.43" r="12.93" fill="none" stroke="#ffdc8c" stroke-miterlimit="10"></circle>
      <circle cx="13.43" cy="13.43" r="10.38" fill="#ffb200"></circle>
      <polygon points="11.32 19.26 11.32 17.43 10.72 17.43 10.71 16.14 10.1 16.21 10.1 15 9.54 14.99 9.46 13.78 8.88 13.78 8.89 13.16 8.28 13.16 8.28 11.34 10.11 11.34 10.11 11.94 10.71 11.94 10.71 6.46 11.33 6.45 11.33 5.86 12.54 5.86 12.54 6.45 13.16 6.47 13.16 8.89 14.37 8.89 14.39 9.49 16.21 9.51 16.21 10.12 17.43 10.12 17.43 10.79 18.04 10.73 18.05 11.39 18.65 11.33 18.65 15.61 18.04 15.52 17.98 17.43 17.43 17.43 17.43 19.26 11.32 19.26" fill="#fff" opacity="0.2"></polygon>
      <g>
        <path d="M10.11,11.94c0-.09,0-0.19,0-0.28s0-.21,0-0.32H8.28v1.82H8.89V11.95h1.23v0.63h0.6v0.6h0.61V13.09q0-2.4,0-4.8,0-.92,0-1.85h1.21V5.85H11.33v0.6H10.71v5.47h-0.6Zm4.28-2.44a0.45,0.45,0,0,1,0-.07c0-.15,0-0.3,0-0.45s0,0,0-.08H13.16V6.47H12.55v5.47h0.61V9.51h1.24s0,0.06,0,.09q0,1.12,0,2.25s0,0.07,0,.1H15V10.12h1.23v2.43h0.6V10.71l0.57,0s0,0,0,.05,0,0.29,0,.44,0,0.07,0,.11H18a0,0,0,0,1,.06.06c0,0.24,0,.48,0,0.72q0,1.71,0,3.41s0,0,0,.08h-0.6s0,0,0,0q0,0.86,0,1.72s0,0,0,.06H16.81v1.21H11.94V17.42H11.33V16.21h-0.6a11.4,11.4,0,0,0,0,1.22h0.6v1.83c2,0,4.07,0,6.11,0,0-.1,0-0.19,0-0.28,0-.46,0-0.93,0-1.39a1.53,1.53,0,0,0,0-.16H18c0.05,0,.07,0,0.07-0.07,0-.45,0-0.89,0-1.34,0-.13,0-0.26,0-0.4l0.3,0h0.3V11.33H18v-0.6H17.43V10.11H16.21V9.51H14.39ZM10.1,15v1.21h0.52a0.07,0.07,0,0,0,.08-0.08c0-.32,0-0.65,0-1,0-.06,0-0.11,0-0.17H10.11V13.77H9.49V13.16H8.91a2.7,2.7,0,0,0,0,.62H9.47s0,0,0,.07,0,0.27,0,.41,0,0.45,0,.68a0,0,0,0,0,.05.06H10.1Z" fill="#fff"></path>
        <path d="M17.43,17.43s0,0,0-.06q0-.86,0-1.72s0,0,0,0H18s0-.06,0-0.08q0-1.71,0-3.41c0-.24,0-0.48,0-0.72A0,0,0,0,0,18,11.33H17.44s0-.07,0-0.11,0-.29,0-0.44,0-.05,0-0.05l-0.57,0v1.84h-0.6V10.12H15v1.82H14.38s0-.07,0-0.1q0-1.12,0-2.25s0-.06,0-0.09h1.81v0.6h1.22v0.62H18v0.6h0.61v4.28h-0.3l-0.3,0c0,0.14,0,.27,0,0.4,0,0.45,0,.89,0,1.34,0,0.05,0,.07-0.07.07H17.43Z" fill="#fff"></path>
        <path d="M17.43,17.43a1.53,1.53,0,0,1,0,.16c0,0.46,0,.93,0,1.39,0,0.09,0,.17,0,0.28-2,0-4.06,0-6.11,0V17.43h-0.6a11.4,11.4,0,0,1,0-1.22h0.6v1.21h0.61v1.22h4.88V17.43h0.62Z" fill="#fff"></path>
        <path d="M11.33,6.45q0,0.92,0,1.85,0,2.4,0,4.8v0.07H10.72v-0.6h-0.6V11.93h0.6V6.46h0.61Z" fill="#fff"></path>
        <path d="M14.39,9.49H13.16v2.43H12.55V6.47h0.61V8.89h1.21s0,0.06,0,.08,0,0.3,0,.45a0.44,0.44,0,0,0,0,.07h0Z" fill="#fff"></path>
        <path d="M10.1,15H9.54a0,0,0,0,1-.05-0.06c0-.23,0-0.45,0-0.68s0-.27,0-0.41,0,0,0-.07H8.88a2.7,2.7,0,0,1,0-.62H9.49v0.61h0.62V15h0.61c0,0.06,0,.12,0,0.17,0,0.32,0,.65,0,1a0.07,0.07,0,0,1-.08.08H10.1V15Z" fill="#fff"></path>
        <path d="M10.11,11.93H8.89v1.21H8.28V11.34h1.83c0,0.11,0,.21,0,0.32s0,0.19,0,.28h0Z" fill="#fff"></path>
        <path d="M11.33,6.45V5.85h1.21v0.6H11.33Z" fill="#fff"></path>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="paths">
    <path id="edge0" d="M66,47v66.12c0.56,24,102,24.22,102,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="edge1" d="M102,47v66.12c0.56,24,68,24.22,68,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="edge2" d="M138.07,47v66.12c0.56,24,33.93,24.22,33.93,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="edge3" d="M174,47V191" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="edge4" d="M210,47v66.12c-0.56,24-34,24.22-34,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="edge5" d="M246,47v66.12c-0.56,24-68,24.22-68,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="edge6" d="M282,47v66.12c-0.56,24-102,24.22-102,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
  </g>
  <use id="array-7-3" data-name="array-7" width="253.5" height="37.5" transform="translate(47.75 10.75)" xlink:href="#array-7"></use>
  <use id="array-7-6" data-name="array-7" width="253.5" height="37.5" transform="translate(47.75 69.75)" xlink:href="#array-7"></use>
  <use id="array-1-3" data-name="array-1" width="37.5" height="37.5" transform="translate(155.75 189.75)" xlink:href="#array-1"></use>
  <g opacity="0.6">
    <text transform="translate(316 34)" font-size="13" font-family="Open Sans">attention</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(316 92)" font-size="13" font-family="Open Sans">memory</text>
  </g>
  <g id="read-result">
    <use width="36" height="36" transform="translate(157 191)" xlink:href="#array-vector"></use>
  </g>
  <g id="attention">
    <use id="array-positive-value-3" data-name="array-positive-value" width="36" height="36" transform="translate(48 11)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(84 11)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(120 11)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(156 11)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(192 11)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(228 11)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(264 11)" xlink:href="#array-positive-value"></use>
  </g>
  <g id="memory">
    <use width="36" height="36" transform="translate(48 71)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(84 71)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(120 71)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(156 71)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(192 71)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(228 71)" xlink:href="#array-vector"></use>
    <use id="array-vector-17" data-name="array-vector" width="36" height="36" transform="translate(264 71)" xlink:href="#array-vector"></use>
  </g>
  <use id="pointer-3" data-name="pointer" width="26.87" height="26.87" transform="translate(9.84 15.06)" xlink:href="#pointer"></use>
  <g opacity="0.6">
    <text transform="translate(440 33.88)" font-size="13" font-family="Open Sans">The RNN gives an attention distribution <tspan x="0" y="20">which describe how we spread out the </tspan><tspan x="0" y="40">amount we care about different memory </tspan><tspan x="0" y="60">positions.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(440 172.81)" font-size="13" font-family="Open Sans">The read result is a weighted sum.</text>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="202" y1="207" x2="203" y2="207" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"></line>
      <line x1="205.01" y1="207" x2="413" y2="207" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.01 2.01"></line>
      <line x1="414" y1="207" x2="415" y2="207" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"></line>
    </g>
  </g>
  <g>
    <path d="M443,205.59a1.5,1.5,0,0,0,0-.17l0.11-.48a4.07,4.07,0,0,1,.22-0.67q0.13-.3.33-0.71a2.31,2.31,0,0,1,.43-0.65,4.86,4.86,0,0,1,.56-0.48,1,1,0,0,1,.72-0.2,2.27,2.27,0,0,1,1.11.26,2.61,2.61,0,0,1,.67.48,0.93,0.93,0,0,1,.24.43,0.23,0.23,0,0,0,.07.13,0.76,0.76,0,0,0,.17-0.15,3.19,3.19,0,0,1,2.41-1.13h0.06a1.69,1.69,0,0,1,1.56.89,2.06,2.06,0,0,1,.17.8,1.74,1.74,0,0,1-.28,1,1.35,1.35,0,0,1-.56.5,1.22,1.22,0,0,1-.54.09,1,1,0,0,1-.69-0.24,0.81,0.81,0,0,1-.26-0.63,1.41,1.41,0,0,1,1.21-1.39A1.66,1.66,0,0,0,450,203a2.8,2.8,0,0,0-2.23,1.6,2.88,2.88,0,0,0-.33.72q-0.11.37-.74,2.88-0.74,3-.85,3.23a1,1,0,0,1-.93.59,0.74,0.74,0,0,1-.46-0.13,0.78,0.78,0,0,1-.24-0.26,0.32,0.32,0,0,1,0-.22q0-.28.87-3.73a37.67,37.67,0,0,0,.87-3.84q0-.85-0.56-0.85a0.93,0.93,0,0,0-.78.61A6.3,6.3,0,0,0,444,205a6.18,6.18,0,0,1-.24.78,0.72,0.72,0,0,1-.35,0h-0.3A0.36,0.36,0,0,1,443,205.59Z" fill="#666"></path>
    <path d="M478.79,206.15v0.24a0.54,0.54,0,0,1-.33.43H461.91l0.37,0.3a5.92,5.92,0,0,1,.63.59q0.3,0.33.71,0.8a4.41,4.41,0,0,1,.72,1.21q0.3,0.74.56,1.54a2.44,2.44,0,0,1,.11.54q0,0.24-.43.24h-0.22a0.17,0.17,0,0,1-.13-0.09,0.85,0.85,0,0,1-.11-0.19,2.1,2.1,0,0,1-.09-0.41,6.62,6.62,0,0,0-1.47-2.82,6.68,6.68,0,0,0-2.64-1.84,0.85,0.85,0,0,1-.39-0.24,0.25,0.25,0,0,1,.09-0.22,1.44,1.44,0,0,1,.3-0.15,6.66,6.66,0,0,0,1.84-1.08,6.43,6.43,0,0,0,1.24-1.32,7.45,7.45,0,0,0,.69-1.28,10.62,10.62,0,0,0,.37-1l0.06-.37,0.07-.17a0.23,0.23,0,0,1,.11-0.09,0.67,0.67,0,0,1,.28,0q0.43,0,.43.24a2.44,2.44,0,0,1-.11.54,9.12,9.12,0,0,1-.54,1.5,6.26,6.26,0,0,1-.69,1.17q-0.37.48-.67,0.8a6.46,6.46,0,0,1-.65.61l-0.43.37h16.55a0.54,0.54,0,0,1,.33.43v-0.24Z" fill="#666"></path>
    <path d="M487.32,191.27s4.41,0,13.11,0h13l1.26,2.93q1.28,3,1.37,3.16h-0.87l-0.15-.3a7.32,7.32,0,0,0-1.21-1.69,9.09,9.09,0,0,0-2.41-1.67,11.86,11.86,0,0,0-3.06-.93,25.21,25.21,0,0,0-3.27-.37q-1.54-.06-4-0.09h-9.71l0.17,0.24q10,13.72,10.08,13.85a0.19,0.19,0,0,1,0,.13L496,213l-5.72,6.5s1.52,0,4.57,0h3.06q1.93,0,2.77,0,2.95,0,4.77-.11a27.83,27.83,0,0,0,3.62-.46,10,10,0,0,0,3.06-1.06,8.13,8.13,0,0,0,2.23-1.89,6.87,6.87,0,0,0,.89-1.56h0.87s-0.05.17-.15,0.46-0.28.76-.54,1.41-0.48,1.26-.67,1.82l-1.26,3.36-13,0q-13,0-13.11,0a0.18,0.18,0,0,1-.13-0.2,0.33,0.33,0,0,1,0-.13L498.81,208s-0.24-.34-0.71-1-1.24-1.68-2.28-3.12-2-2.73-2.82-3.86l-5.76-7.91,0-.33A0.7,0.7,0,0,1,487.32,191.27Z" fill="#666"></path>
    <path d="M499.35,230.92a1.68,1.68,0,0,1,.14-0.47,7.35,7.35,0,0,1,.37-0.78,2.53,2.53,0,0,1,.67-0.78,1.39,1.39,0,0,1,.92-0.34,1.45,1.45,0,0,1,1,.35,1.25,1.25,0,0,1,.41.95,3,3,0,0,1-.21.86q-0.21.6-.61,1.61T501.38,234a2.51,2.51,0,0,0-.08.49q0,0.38.26,0.38a1,1,0,0,0,.29,0,1,1,0,0,0,.35-0.21,2.08,2.08,0,0,0,.41-0.54,4.45,4.45,0,0,0,.38-0.9,0.63,0.63,0,0,1,.08-0.21,0.56,0.56,0,0,1,.26,0q0.31,0,.31.15a1.68,1.68,0,0,1-.14.47,6,6,0,0,1-.38.78,2.56,2.56,0,0,1-.69.77,1.54,1.54,0,0,1-.95.34,1.44,1.44,0,0,1-.9-0.32,1.2,1.2,0,0,1-.43-1,1.54,1.54,0,0,1,.08-0.49q0.08-.23.66-1.75t0.67-1.85a2.54,2.54,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.07,1.07,0,0,0-.84.51,3.57,3.57,0,0,0-.58,1.29l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,499.35,230.92Zm2.5-4.8a0.86,0.86,0,0,1,.29-0.64,1,1,0,0,1,.67-0.29,0.62,0.62,0,0,1,.46.18,0.68,0.68,0,0,1,.2.46,0.87,0.87,0,0,1-.31.64,1,1,0,0,1-.67.31,0.69,0.69,0,0,1-.43-0.15A0.64,0.64,0,0,1,501.84,226.13Z" fill="#666"></path>
    <path d="M528.53,204.7a2,2,0,0,0-.11-0.48,2.06,2.06,0,0,0-.5-0.76,1.39,1.39,0,0,0-1-.43,2.08,2.08,0,0,0-1.45.67,4.53,4.53,0,0,0-1.08,1.76,17.3,17.3,0,0,0-.89,3.55v0.24a1.16,1.16,0,0,1,0,.26,1.82,1.82,0,0,0,.39,1.34,1.4,1.4,0,0,0,.93.39,2.45,2.45,0,0,0,1.63-.72,3.64,3.64,0,0,0,1-1.11q0-.09.59-2.32T528.53,204.7Zm-6.89,3.71a6.4,6.4,0,0,1,1.65-4.16,4.85,4.85,0,0,1,3.71-2,2.46,2.46,0,0,1,2,1.06,1.08,1.08,0,0,1,1-.65,0.78,0.78,0,0,1,.5.17,0.53,0.53,0,0,1,.22.43q0,0.28-.8,3.47t-0.82,3.6a1.16,1.16,0,0,0,.15.71,0.64,0.64,0,0,0,.45.2,0.94,0.94,0,0,0,.43-0.2A4.91,4.91,0,0,0,531,209a0.81,0.81,0,0,1,.22-0.45,0.63,0.63,0,0,1,.22,0h0.09q0.41,0,.41.19a3.44,3.44,0,0,1-.11.59,6.8,6.8,0,0,1-.43,1.17,3.69,3.69,0,0,1-.69,1.08,2.14,2.14,0,0,1-.69.45,2.31,2.31,0,0,1-.52,0,2.21,2.21,0,0,1-1.24-.32,1.66,1.66,0,0,1-.65-0.67l-0.13-.33s0,0-.09,0l-0.09.09a3.8,3.8,0,0,1-2.6,1.21,3,3,0,0,1-2.1-.87A3.65,3.65,0,0,1,521.64,208.41Z" fill="#666"></path>
    <path d="M532.71,210.66a1.68,1.68,0,0,1,.14-0.47,7.35,7.35,0,0,1,.37-0.78,2.53,2.53,0,0,1,.67-0.78,1.39,1.39,0,0,1,.92-0.34,1.45,1.45,0,0,1,1,.35,1.25,1.25,0,0,1,.41.95,3,3,0,0,1-.21.86q-0.21.6-.61,1.61t-0.64,1.73a2.51,2.51,0,0,0-.08.49q0,0.38.26,0.38a1,1,0,0,0,.29,0,1,1,0,0,0,.35-0.21,2.08,2.08,0,0,0,.41-0.54,4.45,4.45,0,0,0,.38-0.9,0.63,0.63,0,0,1,.08-0.21,0.56,0.56,0,0,1,.26,0q0.31,0,.31.15a1.68,1.68,0,0,1-.14.47,6,6,0,0,1-.38.78,2.56,2.56,0,0,1-.69.77,1.54,1.54,0,0,1-.95.34,1.44,1.44,0,0,1-.9-0.32,1.2,1.2,0,0,1-.43-1,1.54,1.54,0,0,1,.08-0.49q0.08-.23.66-1.75t0.67-1.85a2.54,2.54,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.07,1.07,0,0,0-.84.51,3.57,3.57,0,0,0-.58,1.29l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,532.71,210.66Zm2.5-4.8a0.86,0.86,0,0,1,.29-0.64,1,1,0,0,1,.67-0.29,0.62,0.62,0,0,1,.46.18,0.68,0.68,0,0,1,.2.46,0.87,0.87,0,0,1-.31.64,1,1,0,0,1-.67.31,0.69,0.69,0,0,1-.43-0.15A0.64,0.64,0,0,1,535.21,205.87Z" fill="#666"></path>
    <path d="M546.11,198.18a2.36,2.36,0,0,0-1.24-.17,6.23,6.23,0,0,1-.67,0,0.18,0.18,0,0,1-.15-0.22s0-.09,0-0.24l0-.15a0.65,0.65,0,0,0,0-.11,0.38,0.38,0,0,1,0-.11q0-.09,0-0.06s0,0,.09,0a0.11,0.11,0,0,1,.11,0,0.3,0.3,0,0,0,.17,0l0.26,0h0.65l1,0h2a0.43,0.43,0,0,1,.35.11q0,0.09.8,6.11l0.78,6,0.5-.8q0.52-.78,1.39-2.17l1.91-3q3.79-6,3.84-6.09l0.07-.07,0.09-.06,0.13,0h2.95a5.27,5.27,0,0,0,.63,0q0.74,0,.74.24a1.78,1.78,0,0,1-.07.37q-0.07.26-.07,0.28a1.28,1.28,0,0,1-.8.13,9.64,9.64,0,0,0-1.11.07,0.62,0.62,0,0,0-.39.24q-0.06.11-1.56,6.13t-1.52,6.09a0.17,0.17,0,0,0,0,.11l0.15,0.09a0.7,0.7,0,0,0,.37,0,3.47,3.47,0,0,1,.71,0H559a0.78,0.78,0,0,1,.13.24,1.43,1.43,0,0,1-.15.65,0.48,0.48,0,0,1-.35.11l-0.89,0-2,0h-2a6.4,6.4,0,0,0-.76,0q-0.37,0-.37-0.22s0-.13,0-0.3a0.68,0.68,0,0,1,.17-0.39,1.8,1.8,0,0,1,.5-0.07q0.59,0,1.3-.07a0.58,0.58,0,0,0,.41-0.26q0-.09.82-3.16t1.54-6.13l0.76-3.06-4.2,6.7q-4.25,6.76-4.35,6.87l-0.09,0a0.7,0.7,0,0,1-.35.07,0.39,0.39,0,0,1-.39-0.15q0-.09-0.89-6.72l-0.85-6.65-1.47,5.85q-1.45,5.76-1.45,6,0.13,0.72,1.56.72H546a0.42,0.42,0,0,1,.15.2,1,1,0,0,1-.07.39,0.68,0.68,0,0,1-.17.39l-0.24,0h-0.26l-0.74,0-1.39,0-1.34,0-0.8,0a1.17,1.17,0,0,1-.41,0,0.2,0.2,0,0,1-.09-0.2,2.3,2.3,0,0,1,.07-0.3,1.32,1.32,0,0,1,.11-0.33,0.51,0.51,0,0,1,.48-0.13,1.92,1.92,0,0,0,1.93-.87q0.09-.13,1.49-5.81T546.11,198.18Z" fill="#666"></path>
    <path d="M561.18,210.66a1.68,1.68,0,0,1,.14-0.47,7.37,7.37,0,0,1,.37-0.78,2.53,2.53,0,0,1,.67-0.78,1.39,1.39,0,0,1,.92-0.34,1.45,1.45,0,0,1,1,.35,1.25,1.25,0,0,1,.41.95,3,3,0,0,1-.21.86q-0.21.6-.61,1.61t-0.64,1.73a2.51,2.51,0,0,0-.08.49q0,0.38.26,0.38a1,1,0,0,0,.29,0,1,1,0,0,0,.35-0.21,2.08,2.08,0,0,0,.41-0.54,4.45,4.45,0,0,0,.38-0.9,0.63,0.63,0,0,1,.08-0.21,0.56,0.56,0,0,1,.26,0q0.31,0,.31.15a1.68,1.68,0,0,1-.14.47,6,6,0,0,1-.38.78,2.56,2.56,0,0,1-.69.77,1.54,1.54,0,0,1-.95.34,1.44,1.44,0,0,1-.9-0.32,1.2,1.2,0,0,1-.43-1,1.54,1.54,0,0,1,.08-0.49q0.08-.23.66-1.75t0.67-1.85a2.54,2.54,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.07,1.07,0,0,0-.84.51,3.57,3.57,0,0,0-.58,1.29l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,561.18,210.66Zm2.5-4.8a0.86,0.86,0,0,1,.29-0.64,1,1,0,0,1,.67-0.29,0.62,0.62,0,0,1,.46.18,0.68,0.68,0,0,1,.2.46,0.87,0.87,0,0,1-.31.64,1,1,0,0,1-.67.31,0.69,0.69,0,0,1-.43-0.15A0.64,0.64,0,0,1,563.68,205.87Z" fill="#666"></path>
  </g>
</svg>
</dt-include>
  </figure><p></p>

  <p></p><figure class="l-body-outset" id="rnn-write">
    <dt-include src="assets/rnn_write.svg"><svg id="edges" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 744 300">
  <defs>
    <symbol id="array-1" data-name="array-1" viewBox="0 0 37.5 37.5">
      <rect x="0.75" y="0.75" width="36" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"></rect>
    </symbol>
    <symbol id="array-7" data-name="array-7" viewBox="0 0 253.5 37.5">
      <rect x="0.75" y="0.75" width="252" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"></rect>
      <line x1="36.25" y1="36.75" x2="36.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="72.25" y1="36.75" x2="72.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="108.25" y1="36.75" x2="108.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="144.25" y1="36.75" x2="144.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="180.25" y1="36.75" x2="180.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
      <line x1="216.25" y1="36.75" x2="216.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"></line>
    </symbol>
    <symbol id="array-positive-value" data-name="array-positive-value" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#0080f7" opacity="0"></rect>
      <rect x="4.42" y="4.42" width="27.17" height="27.17" rx="6" ry="6" fill="#3a5edd" opacity="0.8"></rect>
    </symbol>
    <symbol id="array-vector" data-name="array-vector" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#d8c2f2" opacity="0"></rect>
      <g opacity="0.5">
        <g>
          <line x1="18" y1="24" x2="18" y2="13.08" fill="none" stroke="#000" stroke-miterlimit="10"></line>
          <polygon points="22.09 16.4 21.36 17.08 18 13.47 14.64 17.08 13.91 16.4 18 12 22.09 16.4"></polygon>
        </g>
      </g>
    </symbol>
    <symbol id="pointer" data-name="pointer" viewBox="0 0 26.87 26.87">
      <circle cx="13.43" cy="13.43" r="12.93" fill="none" stroke="#ffdc8c" stroke-miterlimit="10"></circle>
      <circle cx="13.43" cy="13.43" r="10.38" fill="#ffb200"></circle>
      <polygon points="11.32 19.26 11.32 17.43 10.72 17.43 10.71 16.14 10.1 16.21 10.1 15 9.54 14.99 9.46 13.78 8.88 13.78 8.89 13.16 8.28 13.16 8.28 11.34 10.11 11.34 10.11 11.94 10.71 11.94 10.71 6.46 11.33 6.45 11.33 5.86 12.54 5.86 12.54 6.45 13.16 6.47 13.16 8.89 14.37 8.89 14.39 9.49 16.21 9.51 16.21 10.12 17.43 10.12 17.43 10.79 18.04 10.73 18.05 11.39 18.65 11.33 18.65 15.61 18.04 15.52 17.98 17.43 17.43 17.43 17.43 19.26 11.32 19.26" fill="#fff" opacity="0.2"></polygon>
      <g>
        <path d="M10.11,11.94c0-.09,0-0.19,0-0.28s0-.21,0-0.32H8.28v1.82H8.89V11.95h1.23v0.63h0.6v0.6h0.61V13.09q0-2.4,0-4.8,0-.92,0-1.85h1.21V5.85H11.33v0.6H10.71v5.47h-0.6Zm4.28-2.44a0.45,0.45,0,0,1,0-.07c0-.15,0-0.3,0-0.45s0,0,0-.08H13.16V6.47H12.55v5.47h0.61V9.51h1.24s0,0.06,0,.09q0,1.12,0,2.25s0,0.07,0,.1H15V10.12h1.23v2.43h0.6V10.71l0.57,0s0,0,0,.05,0,0.29,0,.44,0,0.07,0,.11H18a0,0,0,0,1,.06.06c0,0.24,0,.48,0,0.72q0,1.71,0,3.41s0,0,0,.08h-0.6s0,0,0,0q0,0.86,0,1.72s0,0,0,.06H16.81v1.21H11.94V17.42H11.33V16.21h-0.6a11.4,11.4,0,0,0,0,1.22h0.6v1.83c2,0,4.07,0,6.11,0,0-.1,0-0.19,0-0.28,0-.46,0-0.93,0-1.39a1.53,1.53,0,0,0,0-.16H18c0.05,0,.07,0,0.07-0.07,0-.45,0-0.89,0-1.34,0-.13,0-0.26,0-0.4l0.3,0h0.3V11.33H18v-0.6H17.43V10.11H16.21V9.51H14.39ZM10.1,15v1.21h0.52a0.07,0.07,0,0,0,.08-0.08c0-.32,0-0.65,0-1,0-.06,0-0.11,0-0.17H10.11V13.77H9.49V13.16H8.91a2.7,2.7,0,0,0,0,.62H9.47s0,0,0,.07,0,0.27,0,.41,0,0.45,0,.68a0,0,0,0,0,.05.06H10.1Z" fill="#fff"></path>
        <path d="M17.43,17.43s0,0,0-.06q0-.86,0-1.72s0,0,0,0H18s0-.06,0-0.08q0-1.71,0-3.41c0-.24,0-0.48,0-0.72A0,0,0,0,0,18,11.33H17.44s0-.07,0-0.11,0-.29,0-0.44,0-.05,0-0.05l-0.57,0v1.84h-0.6V10.12H15v1.82H14.38s0-.07,0-0.1q0-1.12,0-2.25s0-.06,0-0.09h1.81v0.6h1.22v0.62H18v0.6h0.61v4.28h-0.3l-0.3,0c0,0.14,0,.27,0,0.4,0,0.45,0,.89,0,1.34,0,0.05,0,.07-0.07.07H17.43Z" fill="#fff"></path>
        <path d="M17.43,17.43a1.53,1.53,0,0,1,0,.16c0,0.46,0,.93,0,1.39,0,0.09,0,.17,0,0.28-2,0-4.06,0-6.11,0V17.43h-0.6a11.4,11.4,0,0,1,0-1.22h0.6v1.21h0.61v1.22h4.88V17.43h0.62Z" fill="#fff"></path>
        <path d="M11.33,6.45q0,0.92,0,1.85,0,2.4,0,4.8v0.07H10.72v-0.6h-0.6V11.93h0.6V6.46h0.61Z" fill="#fff"></path>
        <path d="M14.39,9.49H13.16v2.43H12.55V6.47h0.61V8.89h1.21s0,0.06,0,.08,0,0.3,0,.45a0.44,0.44,0,0,0,0,.07h0Z" fill="#fff"></path>
        <path d="M10.1,15H9.54a0,0,0,0,1-.05-0.06c0-.23,0-0.45,0-0.68s0-.27,0-0.41,0,0,0-.07H8.88a2.7,2.7,0,0,1,0-.62H9.49v0.61h0.62V15h0.61c0,0.06,0,.12,0,0.17,0,0.32,0,.65,0,1a0.07,0.07,0,0,1-.08.08H10.1V15Z" fill="#fff"></path>
        <path d="M10.11,11.93H8.89v1.21H8.28V11.34h1.83c0,0.11,0,.21,0,0.32s0,0.19,0,.28h0Z" fill="#fff"></path>
        <path d="M11.33,6.45V5.85h1.21v0.6H11.33Z" fill="#fff"></path>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="paths">
    <path id="path24182" d="M168,48.7c0,52.66-101.44,52.89-102,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="path24184" d="M170,48.7c0,52.66-67.44,52.89-68,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="path24186" d="M172,48.7c0,52.66-33.44,52.89-34,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="path24249" d="M174,48V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="path24264" d="M176,48.7c0,52.66,33.37,52.89,33.93,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="path24262" d="M178,48.7c0,52.66,67.44,52.89,68,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
    <path id="path24260" d="M180,48.7c0,52.66,101.44,52.89,102,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"></path>
  </g>
  <use id="array-1-3" data-name="array-1" width="37.5" height="37.5" transform="translate(154.75 11.75)" xlink:href="#array-1"></use>
  <use id="array-7-3" data-name="array-7" width="253.5" height="37.5" transform="translate(47.75 131.75)" xlink:href="#array-7"></use>
  <use width="253.5" height="37.5" transform="translate(47.75 190.75)" xlink:href="#array-7"></use>
  <use id="array-7-8" data-name="array-7" width="253.5" height="37.5" transform="translate(47.75 250.75)" xlink:href="#array-7"></use>
  <g id="attention">
    <use width="36" height="36" transform="translate(48 132)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(84 132)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(120 132)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(156 132)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(192 132)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(228 132)" xlink:href="#array-positive-value"></use>
    <use width="36" height="36" transform="translate(264 132)" xlink:href="#array-positive-value"></use>
  </g>
  <g opacity="0.6">
    <text transform="translate(316 151)" font-size="13" font-family="Open Sans">attention</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(316 216)" font-size="13" font-family="Open Sans">old memory</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(316 276)" font-size="13" font-family="Open Sans">new memory</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(204 36)" font-size="13" font-family="Open Sans">write value</text>
  </g>
  <g id="write-result">
    <use width="36" height="36" transform="translate(156 12)" xlink:href="#array-vector"></use>
  </g>
  <g id="memory">
    <use width="36" height="36" transform="translate(48 192)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(84 192)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(120 192)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(156 192)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(192 192)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(228 192)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(264 192)" xlink:href="#array-vector"></use>
  </g>
  <g id="new-memory">
    <use width="36" height="36" transform="translate(48 252)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(84 252)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(120 252)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(156 252)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(192 252)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(228 252)" xlink:href="#array-vector"></use>
    <use width="36" height="36" transform="translate(264 252)" xlink:href="#array-vector"></use>
  </g>
  <use width="26.87" height="26.87" transform="translate(9.37 136.54)" xlink:href="#pointer"></use>
  <g opacity="0.6">
    <text transform="translate(438 150.88)" font-size="13" font-family="Open Sans">The RNN gives an attention distribution, <tspan x="0" y="20">describing how much we should change </tspan><tspan x="0" y="40">each memory position towards the write </tspan><tspan x="0" y="60">value.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(440 65.88)" font-size="13" font-family="Open Sans">Instead of writing to one location, we write <tspan x="0" y="20">everywhere, just to different extents.</tspan></text>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="202" y1="73" x2="203" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"></line>
      <line x1="205.01" y1="73" x2="413" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.01 2.01"></line>
      <line x1="414" y1="73" x2="415" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"></line>
    </g>
  </g>
  <g>
    <path d="M450.73,262a2.39,2.39,0,0,0-1.25-.18,6.31,6.31,0,0,1-.68,0,0.19,0.19,0,0,1-.15-0.22s0-.09,0-0.24l0-.15a0.66,0.66,0,0,0,0-.11,0.38,0.38,0,0,1,0-.11q0-.09,0-0.07s0,0,.09,0a0.11,0.11,0,0,1,.11,0,0.31,0.31,0,0,0,.18,0l0.26,0h0.66l1,0h2a0.44,0.44,0,0,1,.35.11q0,0.09.81,6.18l0.79,6.11,0.5-.81q0.53-.79,1.4-2.19l1.93-3.07q3.83-6.11,3.88-6.16l0.07-.07,0.09-.07,0.13,0h3a5.33,5.33,0,0,0,.64,0q0.74,0,.74.24a1.8,1.8,0,0,1-.07.37q-0.07.26-.07,0.28a1.3,1.3,0,0,1-.81.13,9.75,9.75,0,0,0-1.12.07,0.63,0.63,0,0,0-.39.24q-0.07.11-1.58,6.2t-1.53,6.16a0.17,0.17,0,0,0,0,.11l0.15,0.09a0.7,0.7,0,0,0,.37,0,3.5,3.5,0,0,1,.72,0h0.68a0.79,0.79,0,0,1,.13.24,1.45,1.45,0,0,1-.15.66,0.48,0.48,0,0,1-.35.11l-0.9,0-2,0h-2a6.47,6.47,0,0,0-.77,0q-0.37,0-.37-0.22s0-.13,0-0.31a0.69,0.69,0,0,1,.18-0.39,1.82,1.82,0,0,1,.5-0.07q0.59,0,1.31-.07a0.58,0.58,0,0,0,.42-0.26q0-.09.83-3.2t1.56-6.2l0.77-3.09-4.25,6.77q-4.29,6.83-4.4,6.94l-0.09,0a0.71,0.71,0,0,1-.35.07,0.39,0.39,0,0,1-.39-0.15q0-.09-0.9-6.79l-0.85-6.73L450.25,268q-1.47,5.83-1.47,6,0.13,0.72,1.58.72h0.22a0.42,0.42,0,0,1,.15.2,1,1,0,0,1-.07.39,0.69,0.69,0,0,1-.18.39l-0.24,0H450l-0.74,0-1.4,0-1.36,0-0.81,0a1.18,1.18,0,0,1-.42,0,0.2,0.2,0,0,1-.09-0.2,2.33,2.33,0,0,1,.07-0.31,1.34,1.34,0,0,1,.11-0.33,0.51,0.51,0,0,1,.48-0.13,1.94,1.94,0,0,0,1.95-.88q0.09-.13,1.51-5.87T450.73,262Z" fill="#666"></path>
    <path d="M466,274.57a1.7,1.7,0,0,1,.14-0.48,7.43,7.43,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63T468,277.73a2.54,2.54,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.69,1.69,0,0,1-.14.48,6.1,6.1,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,466,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,468.5,269.73Z" fill="#666"></path>
    <path d="M499.93,270v0.24a0.54,0.54,0,0,1-.33.44H482.86l0.37,0.31a6,6,0,0,1,.64.59q0.31,0.33.72,0.81a4.46,4.46,0,0,1,.72,1.23q0.31,0.74.57,1.56a2.46,2.46,0,0,1,.11.55q0,0.24-.44.24h-0.22a0.18,0.18,0,0,1-.13-0.09,0.86,0.86,0,0,1-.11-0.2,2.12,2.12,0,0,1-.09-0.42,6.69,6.69,0,0,0-1.49-2.85,6.76,6.76,0,0,0-2.67-1.86,0.86,0.86,0,0,1-.39-0.24,0.26,0.26,0,0,1,.09-0.22,1.45,1.45,0,0,1,.31-0.15,6.73,6.73,0,0,0,1.86-1.1,6.5,6.5,0,0,0,1.25-1.34,7.54,7.54,0,0,0,.7-1.29,10.74,10.74,0,0,0,.37-1l0.07-.37,0.07-.18a0.24,0.24,0,0,1,.11-0.09,0.68,0.68,0,0,1,.28,0q0.44,0,.44.24a2.46,2.46,0,0,1-.11.55,9.23,9.23,0,0,1-.55,1.51,6.32,6.32,0,0,1-.7,1.18q-0.37.48-.68,0.81a6.53,6.53,0,0,1-.66.61l-0.44.37H499.6a0.54,0.54,0,0,1,.33.44V270Z" fill="#666"></path>
    <path d="M514.93,268.55a2,2,0,0,0-.11-0.48,2.08,2.08,0,0,0-.5-0.77,1.4,1.4,0,0,0-1-.44,2.1,2.1,0,0,0-1.47.68,4.58,4.58,0,0,0-1.1,1.77,17.49,17.49,0,0,0-.9,3.59v0.24a1.17,1.17,0,0,1,0,.26,1.84,1.84,0,0,0,.39,1.36,1.41,1.41,0,0,0,.94.39,2.47,2.47,0,0,0,1.64-.72,3.68,3.68,0,0,0,1-1.12q0-.09.59-2.34T514.93,268.55Zm-7,3.75a6.47,6.47,0,0,1,1.66-4.21,4.9,4.9,0,0,1,3.75-2,2.48,2.48,0,0,1,2,1.07,1.1,1.1,0,0,1,1-.66,0.78,0.78,0,0,1,.5.18,0.54,0.54,0,0,1,.22.44q0,0.28-.81,3.5t-0.83,3.64a1.17,1.17,0,0,0,.15.72,0.64,0.64,0,0,0,.46.2,1,1,0,0,0,.44-0.2,5,5,0,0,0,.9-2.1,0.82,0.82,0,0,1,.22-0.46,0.64,0.64,0,0,1,.22,0h0.09q0.42,0,.42.2a3.48,3.48,0,0,1-.11.59,6.87,6.87,0,0,1-.44,1.18,3.73,3.73,0,0,1-.7,1.1,2.17,2.17,0,0,1-.7.46,2.34,2.34,0,0,1-.53,0,2.24,2.24,0,0,1-1.25-.33,1.68,1.68,0,0,1-.66-0.68l-0.13-.33s0,0-.09,0l-0.09.09A3.84,3.84,0,0,1,511,276a3,3,0,0,1-2.12-.88A3.69,3.69,0,0,1,508,272.29Z" fill="#666"></path>
    <path d="M519.16,274.57a1.7,1.7,0,0,1,.14-0.48,7.43,7.43,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63t-0.65,1.75a2.54,2.54,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.7,1.7,0,0,1-.14.48,6.09,6.09,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,519.16,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,521.68,269.73Z" fill="#666"></path>
    <path d="M539.07,267.3a1.17,1.17,0,0,1,.42-0.85,1.4,1.4,0,0,1,.92-0.42,0.94,0.94,0,0,1,.72.39,2,2,0,0,1,.35,1.25,14.75,14.75,0,0,1-.42,2.52q-0.33,1.23-.59,2a13,13,0,0,1-.77,1.77,4.06,4.06,0,0,1-1.2,1.49,2.64,2.64,0,0,1-1.58.5,4,4,0,0,1-1.71-.35,2.29,2.29,0,0,1-1.07-.94l-0.07.09a2.66,2.66,0,0,1-2.19,1.2,4.5,4.5,0,0,1-1.1-.13,4.12,4.12,0,0,1-1-.42,2.09,2.09,0,0,1-.81-0.85,2.88,2.88,0,0,1-.31-1.38,9.89,9.89,0,0,1,.74-3.2,12,12,0,0,0,.77-2.56v-0.31a0.24,0.24,0,0,0-.09-0.15,0.33,0.33,0,0,0-.24-0.09h-0.09a1.28,1.28,0,0,0-.92.42,3.46,3.46,0,0,0-.66.9,5.79,5.79,0,0,0-.37.92,2.14,2.14,0,0,1-.18.48,0.73,0.73,0,0,1-.35,0H527a0.37,0.37,0,0,1-.13-0.2,2.57,2.57,0,0,1,.18-0.61,9.73,9.73,0,0,1,.5-1.12,3.53,3.53,0,0,1,1-1.14,2.23,2.23,0,0,1,1.42-.5,1.87,1.87,0,0,1,1.45.55,1.82,1.82,0,0,1,.5,1.27,11.71,11.71,0,0,1-.72,2.37,9.67,9.67,0,0,0-.72,3,1.85,1.85,0,0,0,.46,1.42,1.75,1.75,0,0,0,1.16.44,2,2,0,0,0,1.66-1.34l0.11-.2v-0.7a0.45,0.45,0,0,1,0-.18,0.38,0.38,0,0,0,0-.15,0.82,0.82,0,0,1,0-.2l0.07-.28q0-.2.07-0.37a3.35,3.35,0,0,1,.13-0.53,6.15,6.15,0,0,0,.18-0.7q0.07-.35.24-0.94,0.64-2.5.72-2.69a1,1,0,0,1,.94-0.59,0.65,0.65,0,0,1,.57.22,0.91,0.91,0,0,1,.18.42,27.52,27.52,0,0,1-.64,2.8q-0.64,2.52-.7,2.89a4.76,4.76,0,0,0,0,.77v0.15a3,3,0,0,0,.07.64,1.29,1.29,0,0,0,.42.64,1.46,1.46,0,0,0,1,.35q1.56,0,2.48-2.67a13.52,13.52,0,0,0,.44-1.42,7.71,7.71,0,0,0,.26-1.31,2,2,0,0,0-.28-1.14,4.92,4.92,0,0,0-.57-0.7A0.86,0.86,0,0,1,539.07,267.3Z" fill="#666"></path>
    <path d="M551.8,270.54v-0.28a0.48,0.48,0,0,1,.31-0.44h6.55v-3.29l0-3.29a0.58,0.58,0,0,1,.42-0.28,0.48,0.48,0,0,1,.44.33v6.53h6.53a0.46,0.46,0,0,1,0,.88h-6.53v6.53a0.49,0.49,0,0,1-.39.31h-0.09a0.42,0.42,0,0,1-.39-0.31V270.7h-6.55a0.48,0.48,0,0,1-.31-0.44v0.28Z" fill="#666"></path>
    <path d="M578.2,270.26a18,18,0,0,1,.22-2.87,20.09,20.09,0,0,1,.5-2.34,9.18,9.18,0,0,1,.81-1.93q0.53-.94.83-1.47a5.82,5.82,0,0,1,.92-1.14q0.61-.61.72-0.74a3.94,3.94,0,0,1,.55-0.46h0.37q0.31,0,.31.2a1.77,1.77,0,0,1-.37.46,10,10,0,0,0-.9,1.16,15.15,15.15,0,0,0-1.07,1.88,12.47,12.47,0,0,0-.92,3,22.11,22.11,0,0,0-.37,4.23,21.77,21.77,0,0,0,.37,4.21,14.24,14.24,0,0,0,.9,3,9.92,9.92,0,0,0,1.07,1.88q0.55,0.72.92,1.16a4.94,4.94,0,0,1,.37.46q0,0.2-.33.2h-0.35l-0.61-.53a10.81,10.81,0,0,1-3-4.64A17.91,17.91,0,0,1,578.2,270.26Z" fill="#666"></path>
    <path d="M589.33,263.07l-0.28.11a6.28,6.28,0,0,1-.88.22,10.1,10.1,0,0,1-1.27.15h-0.42v-1h0.42a7.12,7.12,0,0,0,1.91-.33,5.18,5.18,0,0,0,1.23-.53,5.62,5.62,0,0,0,.61-0.48,0.33,0.33,0,0,1,.26-0.07,0.61,0.61,0,0,1,.37.13v6.55l0,6.57a0.87,0.87,0,0,0,.26.2,2.6,2.6,0,0,0,.53.09q0.42,0,1.36,0H594v1h-0.24q-0.46-.07-3.48-0.07t-3.44.07h-0.26v-1H588l0.55,0a2.14,2.14,0,0,0,.35-0.07l0.18,0a0.44,0.44,0,0,0,.13-0.11,0.17,0.17,0,0,1,.13-0.09V263.07Z" fill="#666"></path>
    <path d="M598.66,270.54v-0.28a0.48,0.48,0,0,1,.31-0.44h12.73a0.46,0.46,0,0,1,0,.88H599a0.48,0.48,0,0,1-.31-0.44v0.28Z" fill="#666"></path>
    <path d="M622.78,268.55a2,2,0,0,0-.11-0.48,2.08,2.08,0,0,0-.5-0.77,1.4,1.4,0,0,0-1-.44,2.1,2.1,0,0,0-1.47.68,4.59,4.59,0,0,0-1.1,1.77,17.49,17.49,0,0,0-.9,3.59v0.24a1.17,1.17,0,0,1,0,.26,1.84,1.84,0,0,0,.39,1.36,1.41,1.41,0,0,0,.94.39,2.47,2.47,0,0,0,1.64-.72,3.68,3.68,0,0,0,1-1.12q0-.09.59-2.34T622.78,268.55Zm-7,3.75a6.47,6.47,0,0,1,1.66-4.21,4.9,4.9,0,0,1,3.75-2,2.48,2.48,0,0,1,2,1.07,1.1,1.1,0,0,1,1-.66,0.78,0.78,0,0,1,.5.18,0.54,0.54,0,0,1,.22.44q0,0.28-.81,3.5t-0.83,3.64a1.17,1.17,0,0,0,.15.72,0.64,0.64,0,0,0,.46.2,1,1,0,0,0,.44-0.2,5,5,0,0,0,.9-2.1,0.82,0.82,0,0,1,.22-0.46,0.64,0.64,0,0,1,.22,0h0.09q0.42,0,.42.2a3.48,3.48,0,0,1-.11.59,6.87,6.87,0,0,1-.44,1.18,3.73,3.73,0,0,1-.7,1.1,2.17,2.17,0,0,1-.7.46,2.34,2.34,0,0,1-.53,0,2.24,2.24,0,0,1-1.25-.33,1.68,1.68,0,0,1-.66-0.68l-0.13-.33s0,0-.09,0l-0.09.09a3.84,3.84,0,0,1-2.63,1.23,3,3,0,0,1-2.12-.88A3.69,3.69,0,0,1,615.81,272.29Z" fill="#666"></path>
    <path d="M627,274.57a1.69,1.69,0,0,1,.14-0.48,7.45,7.45,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63t-0.65,1.75a2.53,2.53,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.7,1.7,0,0,1-.14.48,6.11,6.11,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,627,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,629.53,269.73Z" fill="#666"></path>
    <path d="M635.53,259.33l0.09,0h0.48l0.61,0.53a10.81,10.81,0,0,1,3,4.64,17.91,17.91,0,0,1,.94,5.78,18.29,18.29,0,0,1-.22,2.87,18.84,18.84,0,0,1-.5,2.34,9.87,9.87,0,0,1-.81,1.93q-0.53,1-.83,1.47a6.67,6.67,0,0,1-.9,1.12l-0.7.72q-0.11.11-.5,0.42l-0.09.09h-0.5a0.13,0.13,0,0,1-.11-0.07,0.52,0.52,0,0,1-.07-0.2l0.24-.28q3.4-3.53,3.4-10.41t-3.4-10.41l-0.24-.28A0.26,0.26,0,0,1,635.53,259.33Z" fill="#666"></path>
    <path d="M649.06,262a2.39,2.39,0,0,0-1.25-.18,6.3,6.3,0,0,1-.68,0,0.19,0.19,0,0,1-.15-0.22s0-.09,0-0.24l0-.15a0.66,0.66,0,0,0,0-.11,0.38,0.38,0,0,1,0-.11q0-.09,0-0.07s0,0,.09,0a0.11,0.11,0,0,1,.11,0,0.31,0.31,0,0,0,.18,0l0.26,0h0.66l1,0h2a0.44,0.44,0,0,1,.35.11q0,0.09.81,6.18l0.79,6.11,0.5-.81q0.53-.79,1.4-2.19l1.93-3.07q3.83-6.11,3.88-6.16l0.07-.07,0.09-.07,0.13,0h3a5.33,5.33,0,0,0,.64,0q0.74,0,.74.24a1.8,1.8,0,0,1-.07.37q-0.07.26-.07,0.28a1.3,1.3,0,0,1-.81.13,9.74,9.74,0,0,0-1.12.07,0.63,0.63,0,0,0-.39.24q-0.07.11-1.58,6.2t-1.53,6.16a0.17,0.17,0,0,0,0,.11l0.15,0.09a0.71,0.71,0,0,0,.37,0,3.5,3.5,0,0,1,.72,0h0.68a0.79,0.79,0,0,1,.13.24,1.45,1.45,0,0,1-.15.66,0.48,0.48,0,0,1-.35.11l-0.9,0-2,0h-2a6.47,6.47,0,0,0-.77,0q-0.37,0-.37-0.22s0-.13,0-0.31a0.69,0.69,0,0,1,.18-0.39,1.82,1.82,0,0,1,.5-0.07q0.59,0,1.31-.07a0.58,0.58,0,0,0,.42-0.26q0-.09.83-3.2t1.56-6.2l0.77-3.09-4.25,6.77q-4.29,6.83-4.4,6.94l-0.09,0a0.71,0.71,0,0,1-.35.07,0.39,0.39,0,0,1-.39-0.15q0-.09-0.9-6.79l-0.85-6.73L648.58,268q-1.47,5.83-1.47,6,0.13,0.72,1.58.72h0.22a0.42,0.42,0,0,1,.15.2,1,1,0,0,1-.07.39,0.69,0.69,0,0,1-.18.39l-0.24,0h-0.26l-0.74,0-1.4,0-1.36,0-0.81,0a1.18,1.18,0,0,1-.42,0,0.2,0.2,0,0,1-.09-0.2,2.33,2.33,0,0,1,.07-0.31,1.34,1.34,0,0,1,.11-0.33,0.51,0.51,0,0,1,.48-0.13,1.94,1.94,0,0,0,1.95-.88q0.09-.13,1.51-5.87T649.06,262Z" fill="#666"></path>
    <path d="M664.31,274.57a1.7,1.7,0,0,1,.14-0.48,7.44,7.44,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63t-0.65,1.75a2.53,2.53,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.7,1.7,0,0,1-.14.48,6.11,6.11,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,664.31,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,666.83,269.73Z" fill="#666"></path>
  </g>
</svg>
</dt-include>
  </figure><p></p>

  <p><dt-include src="assets/rnn_write.html"><script>
"use strict";
(function() {

  function appendArrowhead(selection) {
    selection.append("marker")
        .attr("id", "arrowhead")
        .attr("viewBox", "0 -5 10 10")
        .attr("refX", 5)
        .attr("refY", 0)
        .attr("markerWidth", 10)
        .attr("markerHeight", 10)
        .attr("orient", "auto")
      .append("path")
        .attr("d", "M0,-5L5,0L0,5")
        .style("fill", "none")
        .style("stroke", "grey");
  }

  var vectorScale = d3.scaleLinear()
      .domain([0, 1])
      .range([-14, 14]);

  var memoryData = [
    {x: 0.9, y: 0.9},
    {x: 0.8, y: 0.8},
    {x: 0.1, y: 0.9},
    {x: 0.4, y: 0.2},
    {x: 0.2, y: 0.2},
    {x: 0.4, y: 0.3},
    {x: 0.1, y: 0.5}
  ];

  var writeData = {x: 0.9, y: 0};

  //
  // Read
  //
  var nodeWidth = 36;
  var readHtml = d3.selectAll("#rnn-read");
  var svg = readHtml.select("svg");
  var result = svg.select("#read-result").style("opacity", 0);
  var resultBBox = result.node().getBBox();
  var memory = svg.selectAll("#memory use");
  var memoryBBox = svg.select("#memory").node().getBBox();
  var attention = svg.selectAll("#attention use");
  var attentionBBox = svg.select("#attention").node().getBBox();
  var path = svg.selectAll("#paths path");

  appendArrowhead(svg);
  var resultArrow = svg.append("line")
      .attr("class", "result-line")
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  memory.data(memoryData)
    .each(function(d, i) {
      this.style.opacity = 0;
      d.top = memoryBBox.y;
      d.left = memoryBBox.x + nodeWidth * i;
      d.width = nodeWidth;
    });

  var memoryVectors = svg.selectAll(".vector")
      .data(memoryData)
    .enter().append("line")
      .attr("class", "vector")
      .attr("transform", function(d) {
        return `translate(${d.left + d.width / 2 - vectorScale(d.x) / 2}, ${d.top + d.width / 2 - vectorScale(d.y) / 2})`
      })
      .attr("x2", function(d) { return  vectorScale(d.x); })
      .attr("y2", function(d) { return  vectorScale(d.y); })
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  function updateReadAttention(data) {
    attention.data(data)
        .style("opacity", function(d) { return  d + 0.05; });

    path.data(data)
        .style("stroke-opacity", function(d) { return  d + 0.1; });

    var resultX = d3.sum(memoryData, function(d, i) { return d.x * data[i]; }) / d3.sum(data);
    var resultY = d3.sum(memoryData, function(d, i) { return d.y * data[i]; }) / d3.sum(data);

    resultArrow
        .attr("transform",`translate(${resultBBox.x + resultBBox.width / 2 - vectorScale(resultX) / 2}, ${resultBBox.y + resultBBox.width / 2 - vectorScale(resultY) / 2})`)
        .attr("x2", function(d) { return  vectorScale(resultX); })
        .attr("y2", function(d) { return  vectorScale(resultY); });
  }

  var length = memory.size();
  var attentionData = d3.range(length).map(function() { return Math.random(); });
  updateReadAttention(attentionData);

  readHtml.on("mousemove", function() {
    var data = [];
    attention.each(function() {
      var bbox = this.getBoundingClientRect()
      var distance = Math.abs(bbox.left - d3.event.clientX + bbox.width / 2);
      data.push(Math.exp(-distance / 25));
    });
    data = data.map(function(d) { return  d / d3.sum(data); });
    updateReadAttention(data);
  });

  var initReadData = d3.range(attention.size()).map(function(d) { return  Math.exp(-d); });
  initReadData = initReadData.map(function(d) { return  d / d3.sum(initReadData); });
  updateReadAttention(initReadData);

  //
  // Write
  //

  var writeHtml = d3.selectAll("#rnn-write");
  var writeSvg = writeHtml.select("svg");
  var writeMemory = writeSvg.selectAll("#memory use");
  var writeMemoryBBox = writeSvg.select("#memory").node().getBBox();
  var writeNewMemory = writeSvg.selectAll("#new-memory use");
  var writeNewMemoryBBox = writeSvg.select("#new-memory").node().getBBox();
  var writeAttention = writeSvg.selectAll("#attention use");
  var writeAttentionBBox = writeSvg.select("#attention").node().getBBox();
  var writePath = writeSvg.selectAll("#paths path");
  var writeResult = writeSvg.select("#write-result").style("opacity", 0);
  var writeResultBBox = writeResult.node().getBBox();
  var newMemoryData = memoryData.map(function(){ return {}; });

  appendArrowhead(writeSvg);
  var writeArrow = writeSvg.append("line")
      .attr("class", "write-line")
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey")
      .attr("transform", "translate(" + (writeResultBBox.x + writeResultBBox.width / 2 - vectorScale(writeData.x) / 2) + ", " + (writeResultBBox.y + writeResultBBox.width / 2 - vectorScale(writeData.y) / 2) + ")")
      .attr("x2", vectorScale(writeData.x))
      .attr("y2", vectorScale(writeData.y));

  writeMemory.data(memoryData)
    .each(function(d, i) {
      this.style.opacity = 0;
      d.top = writeMemoryBBox.y;
      d.left = writeMemoryBBox.x + i * nodeWidth;
      d.width = nodeWidth;
    });

  var writeMemoryVectors = writeSvg.selectAll(".vector")
      .data(memoryData)
    .enter().append("line")
      .attr("class", "vector")
      .attr("transform", function(d) {
        return "translate(" + (d.left + d.width / 2 - vectorScale(d.x) / 2) + ", " + (d.top + d.width / 2 - vectorScale(d.y) / 2) + ")";
      })
      .attr("x2", function(d) { return  vectorScale(d.x); })
      .attr("y2", function(d) { return  vectorScale(d.y); })
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  writeNewMemory.data(newMemoryData)
    .each(function(d, i) {
      this.style.opacity = 0;
      d.top = writeNewMemoryBBox.y;
      d.left = writeNewMemoryBBox.x + i * nodeWidth;
      d.width = nodeWidth;
    });

  var writeNewMemoryVectors = writeSvg.selectAll(".new-vector")
      .data(newMemoryData)
    .enter().append("line")
      .attr("class", "new-vector")
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  function updateWriteAttention(data) {
    newMemoryData.forEach(function(d, i) {
      d.x = (memoryData[i].x + writeData.x * data[i]) / (1 + data[i]);
      d.y = (memoryData[i].y + writeData.y * data[i]) / (1 + data[i]);
    });
    writeNewMemoryVectors
        .attr("transform", function(d) {
          return "translate(" + (d.left + d.width / 2 - vectorScale(d.x) / 2) + ", " + (d.top + d.width / 2 - vectorScale(d.y) / 2) + ")";
        })
        .attr("x2", function(d) { return  vectorScale(d.x); })
        .attr("y2", function(d) { return  vectorScale(d.y); });

    writeAttention.data(data)
        .style("opacity", function(d) { return  d + 0.05; });

    writePath.data(data)
        .style("stroke-opacity", function(d) { return  d + 0.1; });
  }

  writeHtml.on("mousemove", function() {
    var data = [];
    writeAttention.each(function() {
      var bbox = this.getBoundingClientRect()
      var distance = Math.abs(bbox.left - d3.event.clientX + bbox.width / 2);
      data.push(Math.exp(-distance / 25));
    });
    data = data.map(function(d) { return  d / d3.sum(data); });
    updateWriteAttention(data);
  });

  var initWriteData = d3.range(writeAttention.size()).map(function(d) { return  Math.exp(-d); });
  initWriteData = initWriteData.map(function(d) { return  d / d3.sum(initWriteData); });
  updateWriteAttention(initWriteData);

})();
</script>
</dt-include></p>




</script>
</dt-include></p>

</dt-article>

<!-- Appendix -->
<dt-appendix class="centered">
  <h3>Acknowledgments</h3>
  <p>Thank you to Maithra Raghu, Dario Amodei, Cassandra Xia, Luke Vilnis, Anna Goldie, Jesse Engel, Dan Man, Natasha Jaques, Emma Pierson and Ian Goodfellow for their feedback and encouragement. We're also very grateful to our team, <a href="http://g.co/brain">Google Brain</a>, for being extremely supportive of our project.</p>

</dt-appendix>
<dt-footer></dt-footer>
<script type="text/bibliography">
@article{alemi2016deepmath,
  author    = {Alex A. Alemi and
               Fran{\c{c}}ois Chollet and
               Geoffrey Irving and
               Christian Szegedy and
               Josef Urban},
  title     = {DeepMath - Deep Sequence Models for Premise Selection},
  journal   = {CoRR},
  volume    = {abs/1606.04442},
  year      = {2016},
  url       = {http://arxiv.org/abs/1606.04442},
  timestamp = {Fri, 01 Jul 2016 17:39:49 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/AlemiCISU16},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{andrychowicz2016learning,
  author    = {Marcin Andrychowicz and
               Karol Kurach},
  title     = {Learning Efficient Algorithms with Hierarchical Attentive Memory},
  journal   = {CoRR},
  volume    = {abs/1602.03218},
  year      = {2016},
  url       = {http://arxiv.org/abs/1602.03218},
  timestamp = {Tue, 01 Mar 2016 17:47:25 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/AndrychowiczK16},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{bahdanau2014neural,
  title={Neural machine translation by jointly learning to align and translate},
  author={Bahdanau, Dzmitry and Cho, Kyunghyun and Bengio, Yoshua},
  journal={arXiv preprint arXiv:1409.0473},
  year={2014}
}

@article{chan2015listen,
  author    = {William Chan and
               Navdeep Jaitly and
               Quoc V. Le and
               Oriol Vinyals},
  title     = {Listen, Attend and Spell},
  journal   = {CoRR},
  volume    = {abs/1508.01211},
  year      = {2015},
  url       = {http://arxiv.org/abs/1508.01211},
  timestamp = {Tue, 01 Sep 2015 14:42:40 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/ChanJLV15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{dzmitry2014neural,
  author    = {Dzmitry Bahdanau and
               Kyunghyun Cho and
               Yoshua Bengio},
  title     = {Neural Machine Translation by Jointly Learning to Align and Translate},
  journal   = {CoRR},
  volume    = {abs/1409.0473},
  year      = {2014},
  url       = {http://arxiv.org/abs/1409.0473},
  timestamp = {Wed, 01 Oct 2014 15:00:04 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/BahdanauCB14},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{graves2014neural,
  author    = {Alex Graves and
               Greg Wayne and
               Ivo Danihelka},
  title     = {Neural Turing Machines},
  journal   = {CoRR},
  volume    = {abs/1410.5401},
  year      = {2014},
  url       = {http://arxiv.org/abs/1410.5401},
  timestamp = {Sun, 02 Nov 2014 11:25:59 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/GravesWD14},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{graves2016adaptive,
  author    = {Alex Graves},
  title     = {Adaptive Computation Time for Recurrent Neural Networks},
  journal   = {CoRR},
  volume    = {abs/1603.08983},
  year      = {2016},
  url       = {http://arxiv.org/abs/1603.08983},
  timestamp = {Sat, 02 Apr 2016 11:49:48 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/Graves16},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@incollection{grefenstette2015learning,
  title = {Learning to Transduce with Unbounded Memory},
  author = {Grefenstette, Edward and Hermann, Karl Moritz and Suleyman, Mustafa and Blunsom, Phil},
  booktitle = {Advances in Neural Information Processing Systems 28},
  editor = {C. Cortes and N. D. Lawrence and D. D. Lee and M. Sugiyama and R. Garnett},
  pages = {1828--1836},
  year = {2015},
  publisher = {Curran Associates, Inc.},
  url = {http://papers.nips.cc/paper/5648-learning-to-transduce-with-unbounded-memory.pdf}
}

@incollection{joulin2015inferring,
  title = {Inferring Algorithmic Patterns with Stack-Augmented Recurrent Nets},
  author = {Joulin, Armand and Mikolov, Tomas},
  booktitle = {Advances in Neural Information Processing Systems 28},
  editor = {C. Cortes and N. D. Lawrence and D. D. Lee and M. Sugiyama and R. Garnett},
  pages = {190--198},
  year = {2015},
  publisher = {Curran Associates, Inc.},
  url = {http://papers.nips.cc/paper/5857-inferring-algorithmic-patterns-with-stack-augmented-recurrent-nets.pdf}
}

@article{kaiser2015neural,
  author    = {Lukasz Kaiser and
               Ilya Sutskever},
  title     = {Neural GPUs Learn Algorithms},
  journal   = {CoRR},
  volume    = {abs/1511.08228},
  year      = {2015},
  url       = {http://arxiv.org/abs/1511.08228},
  timestamp = {Tue, 01 Dec 2015 19:22:34 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/KaiserS15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{kumar2015ask,
  author    = {Ankit Kumar and
               Ozan Irsoy and
               Jonathan Su and
               James Bradbury and
               Robert English and
               Brian Pierce and
               Peter Ondruska and
               Ishaan Gulrajani and
               Richard Socher},
  title     = {Ask Me Anything: Dynamic Memory Networks for Natural Language Processing},
  journal   = {CoRR},
  volume    = {abs/1506.07285},
  year      = {2015},
  url       = {http://arxiv.org/abs/1506.07285},
  timestamp = {Wed, 01 Jul 2015 15:10:24 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/KumarISBEPOGS15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{kurach2015neural,
  author    = {Karol Kurach and
               Marcin Andrychowicz and
               Ilya Sutskever},
  title     = {Neural Random-Access Machines},
  journal   = {CoRR},
  volume    = {abs/1511.06392},
  year      = {2015},
  url       = {http://arxiv.org/abs/1511.06392},
  timestamp = {Tue, 01 Dec 2015 19:22:34 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/KurachAS15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{neelakantan2015neural,
  author    = {Arvind Neelakantan and
               Quoc V. Le and
               Ilya Sutskever},
  title     = {Neural Programmer: Inducing Latent Programs with Gradient Descent},
  journal   = {CoRR},
  volume    = {abs/1511.04834},
  year      = {2015},
  url       = {http://arxiv.org/abs/1511.04834},
  timestamp = {Tue, 01 Dec 2015 19:22:34 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/NeelakantanLS15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{olah2015understanding,
  title={Understanding LSTM Networks},
  author={Olah, Christopher},
  url={http://colah.github.io/posts/2015-08-Understanding-LSTMs},
  year={2015}
}

@article{reed2015neural,
  author    = {Scott E. Reed and
               Nando de Freitas},
  title     = {Neural Programmer-Interpreters},
  journal   = {CoRR},
  volume    = {abs/1511.06279},
  year      = {2015},
  url       = {http://arxiv.org/abs/1511.06279},
  timestamp = {Fri, 08 Apr 2016 07:34:31 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/ReedF15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{silver2016mastering,
  doi = {10.1038/nature16961},
  url = {http://dx.doi.org/10.1038/nature16961},
  year = 2016,
  month = {jan},
  publisher = {Nature Publishing Group},
  volume = {529},
  number = {7587},
  pages = {484--489},
  author = {David Silver and Aja Huang and Chris J. Maddison and Arthur Guez and Laurent Sifre and George van den Driessche and Julian Schrittwieser and Ioannis Antonoglou and Veda Panneershelvam and Marc Lanctot and Sander Dieleman and Dominik Grewe and John Nham and Nal Kalchbrenner and Ilya Sutskever and Timothy Lillicrap and Madeleine Leach and Koray Kavukcuoglu and Thore Graepel and Demis Hassabis},
  title = {Mastering the game of Go with deep neural networks and tree search},
  journal = {Nature}
}

@article{vinyals2015neural,
  author    = {Oriol Vinyals and
               Quoc V. Le},
  title     = {A Neural Conversational Model},
  journal   = {CoRR},
  volume    = {abs/1506.05869},
  year      = {2015},
  url       = {http://arxiv.org/abs/1506.05869},
  timestamp = {Wed, 01 Jul 2015 15:10:24 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/VinyalsL15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{weston2014memory,
  author    = {Jason Weston and
               Sumit Chopra and
               Antoine Bordes},
  title     = {Memory Networks},
  journal   = {CoRR},
  volume    = {abs/1410.3916},
  year      = {2014},
  url       = {http://arxiv.org/abs/1410.3916},
  timestamp = {Sun, 02 Nov 2014 11:25:59 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/WestonCB14},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@article{xu2015show,
  title={Show, attend and tell: Neural image caption generation with visual attention},
  author={Xu, Kelvin and Ba, Jimmy and Kiros, Ryan and Cho, Kyunghyun and Courville, Aaron and Salakhutdinov, Ruslan and Zemel, Richard S and Bengio, Yoshua},
  journal={arXiv preprint arXiv:1502.03044},
  volume={2},
  number={3},
  pages={5},
  year={2015},
  publisher={CoRR}
}

@article{zaremba2015reinforcement,
  author    = {Wojciech Zaremba and
               Ilya Sutskever},
  title     = {Reinforcement Learning Neural Turing Machines},
  journal   = {CoRR},
  volume    = {abs/1505.00521},
  year      = {2015},
  url       = {http://arxiv.org/abs/1505.00521},
  timestamp = {Mon, 01 Jun 2015 14:13:54 +0200},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/ZarembaS15},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}

@inproceedings{vinyals2015grammar,
  title={Grammar as a foreign language},
  author={Vinyals, Oriol and Kaiser, {\L}ukasz and Koo, Terry and Petrov, Slav and Sutskever, Ilya and Hinton, Geoffrey},
  booktitle={Advances in Neural Information Processing Systems},
  pages={2773--2781},
  year={2015}
}

@inproceedings{vinyals2015pointer,
  title={Pointer networks},
  author={Vinyals, Oriol and Fortunato, Meire and Jaitly, Navdeep},
  booktitle={Advances in Neural Information Processing Systems},
  pages={2692--2700},
  year={2015}
}

</script>
</body></html>